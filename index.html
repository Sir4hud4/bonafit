<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonafit Payment - Presentasi Digital</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for Custom Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bonafit-primary': '#FFC107',
                        'bonafit-dark': '#1F2937',
                        'bonafit-bg': '#F3F4F6',
                    },
                },
            },
        }
    </script>
    <style>
        /* Custom Styles for Presentation Feel */
        .min-h-screen {
            min-height: 100vh;
        }
        
        /* Updated AI Output for Chat Functionality */
        .ai-output {
            height: 350px; /* Fixed height for chat box feel */
            overflow-y: auto;
            white-space: pre-wrap;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            border-radius: 0.75rem; /* Rounded corners inherited from parent */
        }

        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style to ensure background images cover the section */
        .bg-cover-center {
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="bg-bonafit-bg">

    <!-- Slide 1: HERO (Introduction & The Big Promise) -->
    <section id="hero" class="min-h-screen flex items-center justify-center p-8 relative overflow-hidden bg-cover-center" 
        style="background-image: url('uploaded:Gemini_Generated_Image_lwgagolwgagolwga.jpg-f2bc62fa-9768-4f44-98ec-dd1c8631dc1c');">
        
        <!-- Dark Overlay for Readability (70% opacity) -->
        <div class="absolute inset-0 bg-black opacity-70 z-0"></div>
        
        <!-- Decorative Circles (Background Element) -->
        <div class="absolute top-[-100px] left-[-100px] w-64 h-64 bg-bonafit-primary opacity-20 rounded-full blur-3xl animate-pulse z-0"></div>
        <div class="absolute bottom-[-100px] right-[-100px] w-80 h-80 bg-bonafit-primary opacity-15 rounded-full blur-3xl animate-pulse delay-300 z-0"></div>

        <div class="relative z-10 max-w-6xl w-full grid md:grid-cols-2 gap-12 items-center text-white">
            <!-- Left: Text Content -->
            <div class="text-center md:text-left space-y-6">
                <p class="text-xl font-medium text-bonafit-primary tracking-widest uppercase">Bonafit Payment</p>
                <h1 class="text-5xl sm:text-6xl font-extrabold leading-tight">
                    Profit Maksimal, <span class="text-bonafit-primary">Transaksi Instan.</span>
                </h1>
                <p class="text-lg text-gray-300">
                    Platform PPOB terdepan yang menjamin kecepatan, harga modal termurah, dan stabilitas server 24/7.
                </p>
                <a href="#features" class="inline-block px-8 py-3 mt-4 text-lg font-bold rounded-full text-bonafit-dark bg-bonafit-primary hover:bg-yellow-600 transition duration-300 shadow-xl">
                    Lihat Fitur Utama &rarr;
                </a>
            </div>
            
            <!-- Right: Visual Mockup -->
            <div class="flex justify-center md:justify-end">
                <img 
                    src="https://placehold.co/400x800/FFC107/1F2937?text=Antarmuka+Aplikasi" 
                    alt="Aplikasi Bonafit Payment di layar ponsel" 
                    class="max-h-[75vh] w-auto rounded-[3rem] p-3 bg-bonafit-dark shadow-[0_20px_50px_rgba(255,193,7,0.5)] transform hover:scale-105 transition duration-500"
                    style="border: 5px solid #FFC107;" 
                    onerror="this.onerror=null;this.src='https://placehold.co/400x800/FFC107/1F2937?text=Mockup+Tidak+Ditemukan';"
                />
            </div>
        </div>
    </section>

    <!-- Slide 2: FEATURES (The "What" - Core Services) - Background tetap solid/light untuk kontras dengan kartu putih -->
    <section id="features" class="min-h-screen flex flex-col justify-center items-center bg-bonafit-bg p-8">
        <div class="max-w-7xl text-center space-y-12">
            <h2 class="text-5xl font-extrabold text-bonafit-dark">Katalog Produk Digital Terlengkap</h2>
            <p class="text-xl text-gray-600 max-w-4xl mx-auto">Kami menyediakan inventaris digital terlengkap, memastikan agen selalu siap melayani segala kebutuhan pelanggan.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Feature 1 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition duration-300 transform hover:-translate-y-1">
                    <div class="text-5xl mb-4 p-2 inline-block rounded-full bg-bonafit-primary/20 text-red-500">ðŸ“±</div>
                    <h3 class="text-xl font-bold text-bonafit-dark mb-2">Pulsa & Data Instan</h3>
                    <p class="text-gray-700 text-sm opacity-85">Harga modal terendah dan proses pengisian secepat kilat.</p>
                </div>
                <!-- Feature 2 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition duration-300 transform hover:-translate-y-1">
                    <div class="text-5xl mb-4 p-2 inline-block rounded-full bg-bonafit-primary/20 text-yellow-500">âš¡</div>
                    <h3 class="text-xl font-bold text-bonafit-dark mb-2">PLN & Token 24/7</h3>
                    <p class="text-gray-700 text-sm opacity-85">Layanan pembelian listrik yang stabil tanpa jam non-aktif.</p>
                </div>
                <!-- Feature 3 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition duration-300 transform hover:-translate-y-1">
                    <div class="text-5xl mb-4 p-2 inline-block rounded-full bg-bonafit-primary/20 text-blue-500">ðŸ’§</div>
                    <h3 class="text-xl font-bold text-bonafit-dark mb-2">PPOB Terlengkap</h3>
                    <p class="text-gray-700 text-sm opacity-85">Bayar PDAM, BPJS, Multifinance, hingga TV Kabel.</p>
                </div>
                <!-- Feature 4 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition duration-300 transform hover:-translate-y-1">
                    <div class="text-5xl mb-4 p-2 inline-block rounded-full bg-bonafit-primary/20 text-indigo-500">ðŸ’³</div>
                    <h3 class="text-xl font-bold text-bonafit-dark mb-2">Top-Up E-Money</h3>
                    <p class="text-gray-700 text-sm opacity-85">Semua dompet digital utama (OVO, Dana, GoPay) tersedia.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 3: WHY US (The "Why" - Trust and Reliability) -->
    <section id="why-us" class="min-h-screen flex flex-col justify-center items-center p-8 relative overflow-hidden bg-cover-center" 
        style="background-image: url('https://placehold.co/1920x1080/F3F4F6/1F2937?text=Tim+Profesional+Diskusi');">

        <!-- Primary Overlay for Branding (80% opacity) -->
        <div class="absolute inset-0 bg-bonafit-primary opacity-80 z-0"></div>

        <div class="relative z-10 max-w-6xl text-center space-y-12 text-bonafit-dark">
            <h2 class="text-5xl font-extrabold">Mengapa Memilih Bonafit?</h2>
            <p class="text-xl max-w-4xl mx-auto">Tiga janji utama kami kepada setiap agen yang bergabung.</p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- USP 1 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl transition duration-300 transform hover:scale-[1.03]">
                    <div class="text-5xl font-extrabold text-bonafit-primary mb-4">ðŸ•’</div>
                    <h3 class="text-xl font-bold mb-2">Jaminan Stabilitas Server</h3>
                    <p class="text-gray-700 text-sm">Server yang stabil 99% uptime, transaksi diproses otomatis tanpa jeda.</p>
                </div>
                <!-- USP 2 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl transition duration-300 transform hover:scale-[1.03]">
                    <div class="text-5xl font-extrabold text-bonafit-primary mb-4">ðŸ”’</div>
                    <h3 class="text-xl font-bold mb-2">Sistem Keamanan Berlapis</h3>
                    <p class="text-gray-700 text-sm">Perlindungan dana dan data pribadi dengan enkripsi dan verifikasi PIN yang kuat.</p>
                </div>
                <!-- USP 3 -->
                <div class="bg-white p-8 rounded-2xl shadow-xl transition duration-300 transform hover:scale-[1.03]">
                    <div class="text-5xl font-extrabold text-bonafit-primary mb-4">ðŸ’°</div>
                    <h3 class="text-xl font-bold mb-2">Komisi Agen Terbaik</h3>
                    <p class="text-gray-700 text-sm">Struktur harga dirancang untuk margin keuntungan tertinggi bagi agen kami.</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Slide 4: GEMINI AI ASSISTANT (Interactive Feature) - Background tetap solid/light -->
    <section id="gemini-assistant" class="min-h-screen flex flex-col justify-center items-center bg-bonafit-bg p-8">
        <div class="w-full max-w-4xl p-4 sm:p-6 rounded-3xl bg-white shadow-2xl border border-gray-200">
            <h2 class="text-3xl font-bold text-bonafit-dark mb-4 text-center">ðŸ’¡ Asisten Bisnis Bertenaga AI (Customer Support)</h2>
            <p class="text-lg text-gray-600 mb-6 text-center">Tanyakan tentang produk, status transaksi, atau masalah umum. Kami siap membantu!</p>

            <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4">
                <input type="text" id="prompt-input"
                       placeholder="Contoh: Bagaimana cara top-up saldo? Atau, Pulsa saya belum masuk." 
                       class="flex-grow p-3 rounded-xl border border-gray-300 focus:ring-bonafit-primary focus:border-bonafit-primary shadow-inner bg-gray-50 text-bonafit-dark"/>
                
                <button id="generate-button"
                        class="flex-shrink-0 px-6 py-3 font-bold rounded-xl text-bonafit-dark bg-bonafit-primary hover:bg-yellow-600 transition duration-300 shadow-lg disabled:opacity-50">
                    <span id="button-text">Tanya Gemini</span>
                    <span id="loading-spinner" class="hidden flex items-center space-x-2">
                        <svg class="animate-spin h-5 w-5 text-bonafit-dark" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Memuat...</span>
                    </span>
                </button>
            </div>

            <div id="output-area" class="ai-output p-4 bg-gray-50 rounded-xl shadow-inner min-h-[100px] text-gray-800 text-sm leading-relaxed border border-gray-200">
                <!-- Chat history will be rendered here -->
            </div>
            
            <div id="sources-container" class="mt-3 text-xs text-gray-500 hidden">
                <p class="font-semibold mb-1">Sumber (Informasi Real-Time):</p>
                <ul id="sources-list" class="list-disc pl-5 space-y-1"></ul>
            </div>
        </div>
    </section>

    <!-- Slide 5: FINAL CTA (Call to Action) -->
    <section id="cta" class="min-h-screen flex flex-col items-center justify-center p-8 relative overflow-hidden bg-cover-center"
        style="background-image: url('https://placehold.co/1920x1080/1F2937/FFC107?text=Grafik+Pertumbuhan+Sukses');">

        <!-- Dark Overlay for Readability (90% opacity) -->
        <div class="absolute inset-0 bg-bonafit-dark opacity-90 z-0"></div>

        <div class="relative z-10 max-w-4xl text-center space-y-8 text-white">
            <h2 class="text-5xl font-extrabold text-bonafit-primary">Siap Berubah?</h2>
            <p class="text-2xl text-gray-300">
                Waktunya beralih ke Bonafit Payment. Unduh aplikasi dan mulai maksimalkan profit bisnis PPOB Anda hari ini.
            </p>
            <a href="https://play.google.com/store/apps/details?id=com.promedia.bonafitpayment" target="_blank" class="inline-flex items-center justify-center px-12 py-5 text-2xl font-bold rounded-xl text-bonafit-dark bg-bonafit-primary hover:bg-yellow-600 transition duration-300 transform hover:scale-105 shadow-2xl">
                <!-- Play Store Icon SVG -->
                <svg class="w-8 h-8 mr-3" fill="currentColor" viewBox="0 0 24 24"><path d="M3 2v20l18-10L3 2zm6 15L6 14v-4l3 3.5V17zm9-7.5L12 16.2V7.8L18 10.5z"/></svg>
                UNDUH SEKARANG
            </a>

            <footer class="mt-16 pt-8 border-t border-gray-700 w-full">
                <p class="text-sm text-gray-500">Â© <span id="current-year"></span> Bonafit Payment. Hak Cipta Dilindungi.</p>
            </footer>
        </div>
    </section>

    <script>
        // --- Global State & Configuration ---
        const MAX_RETRIES = 5;
        const API_MODEL = "gemini-2.5-flash-preview-05-20";
        // Kunci API Gemini akan otomatis ditambahkan oleh Canvas saat 'apiKey' kosong.
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${API_MODEL}:generateContent?key=${apiKey}`;

        // State for Multi-turn Conversation
        let chatHistory = []; 

        // --- DOM Elements ---
        const promptInput = document.getElementById('prompt-input');
        const generateButton = document.getElementById('generate-button');
        const buttonText = document.getElementById('button-text');
        const loadingSpinner = document.getElementById('loading-spinner');
        const outputArea = document.getElementById('output-area');
        const sourcesContainer = document.getElementById('sources-container');
        const sourcesList = document.getElementById('sources-list');
        
        // --- Helper Functions ---

        /**
         * Renders the entire chat history in the output area.
         */
        function renderChat() {
            outputArea.innerHTML = ''; 
            
            if (chatHistory.length === 0) {
                // Initial greeting when history is empty
                const greeting = document.createElement('div');
                greeting.className = 'text-center text-gray-500 italic p-4 text-sm';
                greeting.textContent = "Halo! Saya Asisten AI Tim Customer Support Bonafit Payment. Ada yang bisa saya bantu terkait transaksi atau fitur hari ini?";
                outputArea.appendChild(greeting);
            }
            
            chatHistory.forEach(message => {
                const role = message.role;
                const text = message.parts[0].text;

                const isUser = role === 'user';
                // Styling for chat bubbles
                const roleClass = isUser 
                    ? 'bg-bonafit-primary text-bonafit-dark ml-auto' 
                    : 'bg-gray-200 text-bonafit-dark mr-auto';
                
                const bubble = document.createElement('div');
                bubble.className = `p-3 rounded-xl shadow-md ${roleClass} text-sm`;
                bubble.style.maxWidth = '80%';
                
                // Format text to respect line breaks from the model response
                const formattedText = text.replace(/\n/g, '<br>');
                bubble.innerHTML = formattedText; 
                
                const container = document.createElement('div');
                container.className = `flex ${isUser ? 'justify-end' : 'justify-start'} mb-3`;
                container.appendChild(bubble);
                
                outputArea.appendChild(container);
            });
            
            // Auto-scroll to the latest message
            outputArea.scrollTop = outputArea.scrollHeight;
        }

        /**
         * Executes fetch request with exponential backoff.
         */
        async function fetchWithExponentialBackoff(url, options) {
            for (let i = 0; i < MAX_RETRIES; i++) {
                try {
                    const response = await fetch(url, options);
                    if (response.status !== 429) {
                        return response;
                    }
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                } catch (error) {
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
            throw new Error('Gagal terhubung ke API setelah beberapa kali percobaan.');
        }

        /**
         * Handles the UI state during loading.
         * @param {boolean} isLoading - true to show loading, false to hide.
         */
        function setLoadingState(isLoading) {
            generateButton.disabled = isLoading;
            promptInput.disabled = isLoading;
            buttonText.classList.toggle('hidden', isLoading);
            loadingSpinner.classList.toggle('hidden', !isLoading);
        }

        /**
         * Main function to call Gemini API and maintain conversation history.
         */
        async function generateIdea() {
            const userQuery = promptInput.value.trim();
            if (!userQuery) {
                return;
            }

            // 1. Add user message to history and clear input
            chatHistory.push({ role: "user", parts: [{ text: userQuery }] });
            promptInput.value = '';

            // 2. Update UI with user message and show loading indicator
            setLoadingState(true);
            renderChat(); 
            
            const typingIndicator = document.createElement('div');
            typingIndicator.id = 'typing-indicator';
            typingIndicator.className = 'text-left text-gray-500 italic mb-3 text-sm';
            typingIndicator.textContent = 'Tim CS Bonafit sedang mengetik...';
            outputArea.appendChild(typingIndicator);
            outputArea.scrollTop = outputArea.scrollHeight;

            const systemPrompt = "Bertindaklah sebagai perwakilan **Customer Support** yang profesional, ramah, dan sigap dari Bonafit Payment. Tugas utama Anda adalah membantu pengguna dengan pertanyaan mengenai produk, status transaksi, informasi akun, dan keandalan sistem kami. Selalu pertahankan nada yang membantu, jelas, dan meyakinkan. Prioritaskan solusi praktis, panduan langkah demi langkah, dan penjelasan produk dan proses PPOB Bonafit Payment dalam Bahasa Indonesia yang mudah dipahami. Jika pertanyaan memerlukan data akun spesifik atau real-time (yang tidak dapat Anda akses), mohon arahkan pengguna untuk menghubungi saluran layanan pelanggan resmi kami untuk alasan keamanan.";

            // 3. Send the entire conversation history in the payload
            const payload = {
                contents: chatHistory, 
                tools: [{ "google_search": {} }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                config: { temperature: 0.7 }
            };

            try {
                const response = await fetchWithExponentialBackoff(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) { throw new Error(`API Error: ${response.status} ${response.statusText}`); }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                let generatedText = "Mohon maaf, terjadi kesalahan jaringan. Kami sedang memperbaikinya. Silakan coba lagi.";
                let fetchedSources = [];

                // 4. Extract generated text and update history
                if (candidate && candidate.content?.parts?.[0]?.text) {
                    generatedText = candidate.content.parts[0].text;
                    
                    // Add model response to history for the next turn
                    chatHistory.push({ role: "model", parts: [{ text: generatedText }] });

                    const groundingMetadata = candidate.groundingMetadata;
                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        fetchedSources = groundingMetadata.groundingAttributions
                            .map(attribution => ({ uri: attribution.web?.uri, title: attribution.web?.title }))
                            .filter(source => source.uri && source.title);
                    }
                } else {
                    // Push error message to history if generation failed
                    chatHistory.push({ role: "model", parts: [{ text: generatedText }] });
                }
                
                // 5. Render the full, updated history and sources
                document.getElementById('typing-indicator')?.remove();
                
                if (fetchedSources.length > 0) {
                    sourcesList.innerHTML = ''; 
                    fetchedSources.forEach(source => {
                        const li = document.createElement('li');
                        li.innerHTML = `<a href="${source.uri}" target="_blank" rel="noopener noreferrer" class="text-bonafit-primary hover:underline">${source.title}</a>`;
                        sourcesList.appendChild(li);
                    });
                    sourcesContainer.classList.remove('hidden');
                } else {
                    sourcesContainer.classList.add('hidden');
                }
                
                renderChat();

            } catch (error) {
                document.getElementById('typing-indicator')?.remove();
                const errorMessage = `Mohon maaf, terjadi kesalahan: ${error.message}. Kami sarankan Anda menghubungi layanan support resmi kami.`;
                chatHistory.push({ role: "model", parts: [{ text: errorMessage }] });
                renderChat();
                sourcesContainer.classList.add('hidden');
            } finally {
                setLoadingState(false);
            }
        }

        // --- Initialization ---
        window.onload = function () {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            renderChat(); // Show the initial greeting
            
            // Event Listeners
            generateButton.addEventListener('click', generateIdea);
            promptInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    generateIdea();
                }
            });
        };
    </script>
</body>
</html>
